// --- ELEMENT REFERENCES ---
const progress = document.querySelector(".progress-done");
const input = document.getElementById("inputValue");
const maxInput = document.getElementById("inputMax");

// --- INITIAL VALUES ---
let userPoints = 0;
let goal = 50;


// --- ADD POINTS FUNCTION ---
function addPoints(amount) {
  userPoints += amount;
  console.log(`You gained ${amount} points! Total: ${userPoints}`);
  checkGoal();
  updateProgressBar();
}

// --- SET GOAL FUNCTION ---
function setGoal(newGoal) {
  goal = newGoal;
  console.log(`New goal set: ${goal} points`);
  updateProgressBar();
}

// --- CHECK IF GOAL REACHED ---
function checkGoal() {
  if (userPoints >= goal) {
    console.log("ðŸŽ‰ Goal reached!");
  }
}

// --- RESET POINTS FUNCTION ---
function resetPoints() {
  userPoints = 0;
  console.log("Points reset.");
  updateProgressBar();
}

// --- INPUT LISTENERS
if (input) {
  input.addEventListener("keyup", function () {
    userPoints = parseInt(input.value, 10) || 0;
    updateProgressBar();
  });
}

if (maxInput) {
  maxInput.addEventListener("keyup", function () {
    goal = parseInt(maxInput.value, 10) || 0;
    updateProgressBar();
  });
}


// update progress bar

document.addEventListener("DOMContentLoaded", () => {
  const signedInBar = document.getElementById("signedin-progressbar");
  const notSignedInBar = document.getElementById("not-signedin-progressbar");
  const progressFill = signedInBar.querySelector("#progress-fill");
  const runner = signedInBar.querySelector("#runner");
  const pointText = signedInBar.querySelector("#point-text");

  let isSignedIn = false;
  let userPoints = 0;
  let goal = 50;

  // --- VIEW SWITCH ---
  function updateProgressView() {
    if (isSignedIn) {
      notSignedInBar.style.display = "none";
      signedInBar.style.display = "flex";
      updateProgressBar();
    } else {
      notSignedInBar.style.display = "flex";
      signedInBar.style.display = "none";
    }
  }

  // --- UPDATE BAR ---
  function updateProgressBar() {
    if (!goal || goal <= 0) return;
    const percentage = Math.min((userPoints / goal) * 100, 100);
    progressFill.style.width = `${percentage}%`;
    runner.style.left = `calc(${percentage}% - 15px)`;
    pointText.textContent = `${userPoints}/${goal} points`;
  }

  // --- ADD POINTS ---
  function addPoints(amount) {
    if (!isSignedIn) return console.log("User not signed in.");
    userPoints += amount;
    updateProgressBar();
  }

  // --- SIMULATE SIGN-IN ---
  function signIn() {
    isSignedIn = true;
    console.log("âœ… User signed in");
    updateProgressView();
  }

  function signOut() {
    isSignedIn = false;
    console.log("ðŸšª User signed out");
    updateProgressView();
  }

  // --- INIT ---
  updateProgressView();

  // --- TEST ---
  signIn();
  addPoints(0);
  addPoints(15);
  signOut();
});
